<style>
    #progressbox {
    border: 1px solid #0099CC;
    padding: 1px; 
    position:relative;
    width:400px;
    border-radius: 3px;
    margin: 10px;
    /*display:none;*/
    text-align:left;
    }
    #progressbar {
    height:20px;
    border-radius: 3px;
    background-color: #003333;
    width:1%;
    }
    #statustext {
    top:3px;
    left:50%;
    position:absolute;
    display:inline-block;
    color: #000000;
    }
    .animation {
        width: 100%;
        margin: 2em auto;
        height: 4px;
        background-color: rgb(232, 125, 62);
        -webkit-animation: change_colour 10s linear 0s infinite alternate;
        animation: change_colour 10s linear 0s infinite alternate;
    }

    @-webkit-keyframes change_colour {
        0% {
            /* orange */
            background-color: rgb(232, 125, 62);
        }
        20% {
            /* yellow */
            background-color: rgb(229, 181, 103);
        }
        40% {
            /* green */
            background-color: rgb(180, 210, 115);
        }
        60% {
            /* blue */
            background-color: rgb(108, 153, 187);
        }
        80% {
            /* purple */
            background-color: rgb(158, 134, 200);
        }
        100% {
            /* pink */
            background-color: rgb(176, 82, 121);
        }
    }
    @keyframes change_colour {
        0% {
            /* orange */
            background-color: rgb(232, 125, 62);
        }
        20% {
            /* yellow */
            background-color: rgb(229, 181, 103);
        }
        40% {
            /* green */
            background-color: rgb(180, 210, 115);
        }
        60% {
            /* blue */
            background-color: rgb(108, 153, 187);
        }
        80% {
            /* purple */
            background-color: rgb(158, 134, 200);
        }
        100% {
            /* pink */
            background-color: rgb(176, 82, 121);
        }
    }
</style>

<div class="animation"></div>

<div id="upload-wrapper">
    <span>Allowed: jpg, jpeg png, gif</span>
    <form action="/api/photos" method="post" enctype="multipart/form-data" id="upload">
        <input type="file" name="photo" id="photo">
        <input type="submit" value="Upload" id="submit-btn">
    </form>
    <div id="progressbox">
        <div id="progressbar"></div>
        <div id="statustext">0%</div>
    </div>
    <div id="output"></div>
</div>

<script src="js/lib/jquery-2.1.3.min.js"></script>
<script src="/js/lib/jquery.form.min.js"></script>

<script>
    function onProgress(e, position, total, percentComplete) {
        $('#progressbar').width(percentComplete + '%');
        $('#statustext').html(percentComplete + '%');
        if(percentComplete > 50) {
            $('#statustext').css('color', '#fff');
        }
    }

    function beforeSubmit() {
        if(window.File && window.FileReader && window.FileList && window.Blob) {
            if(!$('#photo').val()) {
                $('#output').html('No photo!');
                return false;
            }

            var size = $('#photo')[0].files[0].size;
            var type = $('#photo')[0].files[0].type;

            switch(type) {
            case 'image/png':
            case 'image/jpg':
            case 'image/jpeg':
            case 'image/gif':
                break;
            default:
                $('#output').html('That\'s no image! ' + type);
                return false;
            }

            if(size > 1048576) {
                $('#output').html(size + ' is too big!');
                return false;
            }

            // $('#submit-btn').hide();
            // show loading anim
            $('#output').html();
        } else {
            $('#output').html('Not supported in your browser');
            return false;
        }
    }

    function afterSuccess(responseText, statusText, xhr, el) {
        console.log(responseText, statusText, xhr, el);
        alert('finished!');
    }

    $(document).ready(function() {
        var options = {
            target: '#output',
            beforeSubmit: beforeSubmit,
            uploadProgress: onProgress,
            success: afterSuccess,
            resetForm: true
        };
        $('#upload').submit(function(e) {
            $(this).ajaxSubmit(options);
            return false;
        });
    });
</script>